<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸–ç•Œè¨ˆç•« & åˆéŸ³å‘¨é‚Šæ”¶è—åº«</title>
    <style>
        :root { 
            --miku-green: #00C2B3; 
            --sekai-purple: #6c5ce7; 
            --sekai-pink: #ff79c6;
            --bg: #f0f4f8; 
            --card: #ffffff; 
        }
        body { font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif; background: var(--bg); margin: 0; padding: 15px; color: #2d3436; }
        .container { max-width: 1100px; margin: 0 auto; }
        
        /* æ¼¸å±¤æ¨™é¡Œèˆ‡èƒŒæ™¯ */
        header { 
            background: linear-gradient(135deg, var(--miku-green), var(--sekai-purple)); 
            padding: 30px; border-radius: 20px; color: white; text-align: center; margin-bottom: 25px;
            box-shadow: 0 10px 20px rgba(108, 92, 231, 0.2);
        }

        /* çµ±è¨ˆèˆ‡æœå°‹ */
        .stats-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 20px; }
        .stat-box { background: white; padding: 15px; border-radius: 15px; text-align: center; border-bottom: 4px solid var(--miku-green); }
        .stat-box h3 { margin: 0; font-size: 14px; color: #666; }
        .stat-val { font-size: 24px; font-weight: bold; margin-top: 5px; color: var(--sekai-purple); }

        .search-area { display: flex; gap: 10px; margin-bottom: 25px; }
        input.search-bar { flex: 1; padding: 12px; border-radius: 10px; border: 1px solid #ddd; outline: none; }

        /* è¡¨å–®å€åŸŸ */
        .form-card { background: white; padding: 25px; border-radius: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-bottom: 30px; }
        .grid-form { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px; }
        label { display: block; font-size: 13px; font-weight: bold; margin-bottom: 5px; color: #444; }
        input, select, textarea { width: 100%; padding: 10px; border: 1px solid #eee; border-radius: 8px; box-sizing: border-box; background: #fafafa; }
        
        .btn-submit { background: linear-gradient(to right, var(--miku-green), var(--sekai-purple)); color: white; border: none; padding: 15px; border-radius: 10px; width: 100%; margin-top: 20px; font-size: 16px; font-weight: bold; cursor: pointer; transition: 0.3s; }
        .btn-submit:hover { opacity: 0.9; transform: scale(1.01); }

        /* ç•«å»Šå¡ç‰‡ */
        .gallery { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .item-card { background: white; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.08); position: relative; border: 1px solid #f0f0f0; }
        .item-img { width: 100%; height: 220px; object-fit: cover; background: #eee; }
        .item-content { padding: 15px; }
        .tag-work { background: var(--sekai-purple); color: white; padding: 2px 8px; border-radius: 5px; font-size: 11px; margin-right: 5px; }
        .tag-type { background: var(--miku-green); color: white; padding: 2px 8px; border-radius: 5px; font-size: 11px; }
        .price-text { color: #ff4757; font-size: 20px; font-weight: bold; margin: 10px 0; }
        .info-row { font-size: 12px; color: #777; line-height: 1.6; }
        .del-btn { position: absolute; top: 10px; right: 10px; background: rgba(255,255,255,0.9); border: none; padding: 5px 8px; border-radius: 5px; color: #ff4757; cursor: pointer; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>VOCALOID & Project SEKAI</h1>
        <p>æˆ‘çš„å‘¨é‚Šæ•—å®¶èˆ‡é–‹ç®±ç´€éŒ„å€‰åº«</p>
    </header>

    <div class="stats-row">
        <div class="stat-box">
            <h3>ç¸½æ”¶è—æ•¸é‡</h3>
            <div class="stat-val" id="countDisplay">0</div>
        </div>
        <div class="stat-box">
            <h3>ç¸½ç‡ƒç‡’ç¶“è²»</h3>
            <div class="stat-val" id="totalDisplay">0</div>
        </div>
    </div>

    <div class="search-area">
        <input type="text" id="searchInput" class="search-bar" placeholder="ğŸ” æœå°‹è§’è‰²ã€å‘¨é‚Šåç¨±æˆ–é—œéµå­—..." oninput="renderGallery()">
        <select id="filterWork" onchange="renderGallery()" style="width: auto; border-radius: 10px;">
            <option value="">æ‰€æœ‰ä½œå“</option>
            <option value="ä¸–ç•Œè¨ˆç•« (PJSK)">ä¸–ç•Œè¨ˆç•« (PJSK)</option>
            <option value="VOCALOID / åˆéŸ³æœªä¾†">VOCALOID / åˆéŸ³æœªä¾†</option>
        </select>
    </div>

    <div class="form-card">
        <form id="merchForm">
            <div class="grid-form">
                <div>
                    <label>ä½œå“åˆ†é¡</label>
                    <select id="workName">
                        <option value="ä¸–ç•Œè¨ˆç•« (PJSK)">ä¸–ç•Œè¨ˆç•« (PJSK)</option>
                        <option value="VOCALOID / åˆéŸ³æœªä¾†">VOCALOID / åˆéŸ³æœªä¾†</option>
                        <option value="å…¶ä»–">å…¶ä»–</option>
                    </select>
                </div>
                <div>
                    <label>å‘¨é‚Šåç¨± (å«è§’è‰²)</label>
                    <input type="text" id="itemName" placeholder="ä¾‹ï¼š25æ™‚ æ›‰å±±ç‘å¸Œ é–ƒå¾½" required>
                </div>
                <div>
                    <label>å‘¨é‚Šé¡åˆ¥</label>
                    <select id="itemType">
                        <option value="è¥Ÿç«  (å¾½ç« /ç¼¶ãƒãƒƒã‚¸)">è¥Ÿç«  (å¾½ç« /ç¼¶ãƒãƒƒã‚¸)</option>
                        <option value="è‰²ç´™ (Shikishi)">è‰²ç´™ (Shikishi)</option>
                        <option value="æ‹ç«‹å¾—/Pera-pachi">æ‹ç«‹å¾—/Pera-pachi</option>
                        <option value="ç«‹ç‰Œ (Acrylic Stand)">ç«‹ç‰Œ (Acrylic Stand)</option>
                        <option value="åŠé£¾/æ›ä»¶">åŠé£¾/æ›ä»¶</option>
                        <option value="å…¬ä»”/æ™¯å“/é»åœŸäºº">å…¬ä»”/æ™¯å“/é»åœŸäºº</option>
                        <option value="é†œå¨ƒ/å¡«å……ç©å¶/è¶´è¶´">é†œå¨ƒ/å¡«å……ç©å¶/è¶´è¶´</option>
                        <option value="ç´™é¡/å°å¡/æ˜ä¿¡ç‰‡">ç´™é¡/å°å¡/æ˜ä¿¡ç‰‡</option>
                        <option value="CD/å°ˆè¼¯/è—å…‰BD">CD/å°ˆè¼¯/è—å…‰BD</option>
                        <option value="æœé£¾/ç—›åŒ…é…ä»¶">æœé£¾/ç—›åŒ…é…ä»¶</option>
                    </select>
                </div>
                <div>
                    <label>åƒ¹éŒ¢ (NTD)</label>
                    <input type="number" id="price" placeholder="0" required>
                </div>
                <div>
                    <label>è³¼è²·ä¾†æº</label>
                    <input type="text" id="source" placeholder="ä¾‹ï¼šMercariã€å®‰åˆ©ç¾ç‰¹">
                </div>
                <div>
                    <label>è³¼è²·æ—¥æœŸ</label>
                    <input type="date" id="buyDate">
                </div>
            </div>
            
            <div style="margin-top: 15px; display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <div>
                    <label>è³¼è²·ç¶²å€</label>
                    <input type="url" id="buyUrl" placeholder="https://...">
                </div>
                <div>
                    <label>ä¸Šå‚³ç…§ç‰‡</label>
                    <input type="file" id="imageFile" accept="image/*">
                </div>
            </div>

            <div style="margin-top: 15px;">
                <label>å‚™è¨»</label>
                <textarea id="note" rows="2" placeholder="è©³ç´°è¦æ ¼ã€æ”¶å–®æ—¥æœŸæˆ–åŒ…è£¹ç‹€æ…‹..."></textarea>
            </div>

            <button type="submit" class="btn-submit">âœ¨ è¨˜éŒ„é€™ä¸€ç­†æˆ°åˆ©å“</button>
        </form>
    </div>

    <div class="gallery" id="merchGallery"></div>
</div>

<script>
    let merchList = JSON.parse(localStorage.getItem('miku_sekai_data')) || [];

    function renderGallery() {
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        const workFilter = document.getElementById('filterWork').value;
        const gallery = document.getElementById('merchGallery');
        gallery.innerHTML = '';

        let total = 0;
        let count = 0;

        const filtered = merchList.filter(item => {
            const matchSearch = item.name.toLowerCase().includes(searchTerm) || 
                               item.note.toLowerCase().includes(searchTerm);
            const matchWork = workFilter === "" || item.work === workFilter;
            return matchSearch && matchWork;
        });

        filtered.forEach((item, index) => {
            total += Number(item.price);
            count++;
            const card = document.createElement('div');
            card.className = 'item-card';
            card.innerHTML = `
                <img src="${item.img || 'https://via.placeholder.com/300x200?text=Wait+for+Photo'}" class="item-img">
                <button class="del-btn" onclick="deleteItem(${index})">âœ•</button>
                <div class="item-content">
                    <div><span class="tag-work">${item.work}</span><span class="tag-type">${item.type}</span></div>
                    <h3 style="margin:10px 0 5px 0; font-size:18px;">${item.name}</h3>
                    <div class="price-text">$ ${Number(item.price).toLocaleString()}</div>
                    <div class="info-row">
                        ğŸª ä¾†æºï¼š${item.source || '-'}<br>
                        ğŸ“… æ—¥æœŸï¼š${item.date || '-'}<br>
                        ğŸ’¬ å‚™è¨»ï¼š${item.note || 'ç„¡'}
                    </div>
                    ${item.url ? `<a href="${item.url}" target="_blank" style="color:var(--sekai-purple); font-size:12px; text-decoration:none; display:block; margin-top:10px;">âœ é»æˆ‘å‰å¾€è³¼è²·ç¶²å€</a>` : ''}
                </div>
            `;
            gallery.appendChild(card);
        });

        document.getElementById('totalDisplay').innerText = total.toLocaleString();
        document.getElementById('countDisplay').innerText = count;
    }

    document.getElementById('merchForm').addEventListener('submit', function(e) {
        e.preventDefault();
        const file = document.getElementById('imageFile').files[0];
        const processSave = (imgBase64) => {
            const newItem = {
                work: document.getElementById('workName').value,
                name: document.getElementById('itemName').value,
                type: document.getElementById('itemType').value,
                price: document.getElementById('price').value,
                source: document.getElementById('source').value,
                date: document.getElementById('buyDate').value,
                url: document.getElementById('buyUrl').value,
                note: document.getElementById('note').value,
                img: imgBase64
            };
            merchList.unshift(newItem);
            localStorage.setItem('miku_sekai_data', JSON.stringify(merchList));
            this.reset();
            renderGallery();
        };

        if (file) {
            const reader = new FileReader();
            reader.onloadend = () => processSave(reader.result);
            reader.readAsDataURL(file);
        } else {
            processSave(null);
        }
    });

    function deleteItem(index) {
        if(confirm('è¦å¿ç—›åˆªé™¤é€™ç­†æ”¶è—ç´€éŒ„å—ï¼Ÿ')) {
            merchList.splice(index, 1);
            localStorage.setItem('miku_sekai_data', JSON.stringify(merchList));
            renderGallery();
        }
    }

    renderGallery();
</script>
</body>
</html>
